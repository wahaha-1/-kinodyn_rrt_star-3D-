
ç”¨äºç”Ÿæˆæ— äººæœºè½¨è¿¹è§„åˆ’çš„è®­ç»ƒæ•°æ®é›†ï¼ŒåŒ…å« **3D éšœç¢ç‰©åœ°å›¾** å’Œ **ç¬¦åˆåŠ¨åŠ›å­¦çº¦æŸçš„è½¨è¿¹**ã€‚

## ğŸ“‹ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®é›†ç”Ÿæˆæµç¨‹                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  1. obstruct_env - ç¯å¢ƒä¸åœ°å›¾ç”Ÿæˆ         â”‚
        â”‚     â”œâ”€ ç”Ÿæˆ 3D éšœç¢ç‰©åœ°å›¾ï¼ˆå æ®æ …æ ¼ï¼‰       â”‚
        â”‚     â”œâ”€ è®¡ç®— ESDFï¼ˆè·ç¦»åœºï¼‰                â”‚
        â”‚     â””â”€ é‡‡æ ·èµ·ç‚¹ä¸ç»ˆç‚¹                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  2. cpp_bridge - Python-C++ æ¡¥æ¥        â”‚
        â”‚     â””â”€ å°†åœ°å›¾å’Œä»»åŠ¡ä¼ é€’ç»™ C++ è§„åˆ’å™¨      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  3. cpp/kinodyn_rrt_star - è½¨è¿¹è§„åˆ’    â”‚
        â”‚     â”œâ”€ Kinodynamic RRT* ç®—æ³•            â”‚
        â”‚     â”œâ”€ ç”Ÿæˆå¤šé¡¹å¼è½¨è¿¹ç³»æ•°                 â”‚
        â”‚     â””â”€ è¾“å‡ºè½¨è¿¹é‡‡æ ·ç‚¹ä¸å…ƒæ•°æ®             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  4. æ‰“åŒ…è¾“å‡º - NPZ æ ¼å¼æ•°æ®é›†            â”‚
        â”‚     â”œâ”€ åœ°å›¾ + ESDF                      â”‚
        â”‚     â”œâ”€ å¤šä¸ªä»»åŠ¡ï¼ˆèµ·ç‚¹ã€ç»ˆç‚¹ã€åå¥½ï¼‰        â”‚
        â”‚     â””â”€ è½¨è¿¹ï¼ˆç³»æ•°ã€é‡‡æ ·ç‚¹ã€ä»£ä»·ï¼‰          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ æ ¸å¿ƒç›®å½•ç»“æ„

### `obstruct_env/` - ç¯å¢ƒç”Ÿæˆæ¨¡å—

```
obstruct_env/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ obstacle_map.py        # 3D å æ®æ …æ ¼åœ°å›¾ç”Ÿæˆå™¨
â”‚   â””â”€â”€ esdf.py                # æ¬§å‡ é‡Œå¾—ç¬¦å·è·ç¦»åœºè®¡ç®—
â”œâ”€â”€ generators/
â”‚   â”œâ”€â”€ advanced_obstacle_generator.py  # é«˜çº§éšœç¢ç‰©ç”Ÿæˆ
â”‚   â”œâ”€â”€ environment_builder.py          # ç¯å¢ƒæ„å»ºå™¨
â”‚   â””â”€â”€ generate_map.py                 # åœ°å›¾ç”Ÿæˆå·¥å…·
â”œâ”€â”€ datasets/
â”‚   â”œâ”€â”€ generate_dataset.py    # ğŸ¯ ä¸»æ•°æ®é›†ç”Ÿæˆè„šæœ¬
â”‚   â”œâ”€â”€ dataset_config.yaml    # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ README.md              # ä½¿ç”¨è¯´æ˜
â””â”€â”€ visualization/             # å¯è§†åŒ–å·¥å…·
```

**ä¸»è¦åŠŸèƒ½ï¼š**
- ç”Ÿæˆå¤šç§ç±»å‹çš„éšœç¢ç‰©ï¼ˆç›’å­ã€çƒä½“ã€åœ†æŸ±ã€æ¤­çƒï¼‰
- æ”¯æŒé¢„è®¾ç¯å¢ƒï¼ˆåŸå¸‚ã€æ£®æ—ã€å»ºç­‘ç¾¤ï¼‰
- è®¡ç®— ESDF ç”¨äºè½¯çº¦æŸè§„åˆ’
- æ™ºèƒ½é‡‡æ ·èµ·ç‚¹å’Œç»ˆç‚¹ï¼ˆä¿è¯å¯è¾¾æ€§å’Œæœ€å°è·ç¦»ï¼‰

### `cpp/kinodyn_rrt_star/` - C++ è½¨è¿¹è§„åˆ’å™¨

```
cpp/kinodyn_rrt_star/
â”œâ”€â”€ include/
â”‚   â””â”€â”€ kinodyn_rrt_star/
â”‚       â””â”€â”€ kinodyn_rrt_star.h    # å…¬å…± API
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ kinodyn_rrt_star.cpp      # è§„åˆ’å™¨å®ç°
â”‚   â””â”€â”€ kdtree.cpp                # KD æ ‘å®ç°
â”œâ”€â”€ app/
â”‚   â””â”€â”€ main.cpp                  # å‘½ä»¤è¡Œå…¥å£
â”œâ”€â”€ build/                        # ç¼–è¯‘è¾“å‡ºç›®å½•
â””â”€â”€ CMakeLists.txt                # æ„å»ºé…ç½®
```

**ä¸»è¦åŠŸèƒ½ï¼š**
- Kinodynamic RRT* é‡‡æ ·è§„åˆ’
- è€ƒè™‘é€Ÿåº¦ã€åŠ é€Ÿåº¦çº¦æŸ
- ç”Ÿæˆå¹³æ»‘çš„å¤šé¡¹å¼è½¨è¿¹
- æ”¯æŒ ESDF è½¯å®‰å…¨ä»£ä»·ä¼˜åŒ–

### æ¡¥æ¥æ–‡ä»¶

- **`cpp_bridge.py`** - Python è°ƒç”¨ C++ è§„åˆ’å™¨
  - æ”¯æŒå¯æ‰§è¡Œæ–‡ä»¶æ¨¡å¼ï¼ˆé€šè¿‡ JSON é€šä¿¡ï¼‰
  - æ”¯æŒ pybind11 æ¨¡å¼ï¼ˆç›´æ¥è°ƒç”¨ï¼Œæ›´å¿«ï¼‰
  
- **`standalone_trajectory_generator.py`** - çº¯ Python å¤‡ç”¨å®ç°
  - ä¸ä¾èµ– C++ ç¼–è¯‘
  - åŠŸèƒ½ç›¸å¯¹ç®€åŒ–ï¼Œé€Ÿåº¦è¾ƒæ…¢

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

#### å®‰è£… Python ä¾èµ–
```bash
pip install -r requirements.txt
```

ä¸»è¦ä¾èµ–ï¼š
- `numpy` - æ•°ç»„è®¡ç®—
- `scipy` - ESDF è·ç¦»å˜æ¢
- `pyyaml` - é…ç½®æ–‡ä»¶è§£æ
- `matplotlib` - å¯è§†åŒ–ï¼ˆå¯é€‰ï¼‰

#### ç¼–è¯‘ C++ è§„åˆ’å™¨
```bash
cd cpp/kinodyn_rrt_star
mkdir -p build && cd build
cmake ..
cmake --build . -j
```

ä¾èµ–ï¼š
- CMake >= 3.10
- C++14 ç¼–è¯‘å™¨ï¼ˆGCC/Clangï¼‰
- Eigen3 åº“ï¼ˆ`sudo apt install libeigen3-dev`ï¼‰

éªŒè¯ç¼–è¯‘æˆåŠŸï¼š
```bash
./bin/kino_rrt_planner --help
```

### 2. ç”Ÿæˆæ•°æ®é›†

#### ä½¿ç”¨é»˜è®¤é…ç½®
```bash
python3 obstruct_env/datasets/generate_dataset.py \
    --config obstruct_env/datasets/dataset_config.yaml
```

#### è‡ªå®šä¹‰å‚æ•°
```bash
python3 obstruct_env/datasets/generate_dataset.py \
    --config obstruct_env/datasets/dataset_config.yaml \
    --num-maps 10 \          # ç”Ÿæˆ 10 å¼ åœ°å›¾
    --tasks-per-map 5 \      # æ¯å¼ åœ°å›¾ 5 æ¡è½¨è¿¹
    --seed 42                # å›ºå®šéšæœºç§å­
```

#### è¾“å‡ºç»“æ„
```
obstruct_env/datasets/out/
â”œâ”€â”€ maps/
â”‚   â”œâ”€â”€ map_00001_occ.npy    # å æ®æ …æ ¼
â”‚   â”œâ”€â”€ map_00001_esdf.npy   # è·ç¦»åœº
â”‚   â”œâ”€â”€ map_00002_occ.npy
â”‚   â””â”€â”€ ...
â”œâ”€â”€ dataset/
â”‚   â”œâ”€â”€ map_00001.npz        # å®Œæ•´æ•°æ®åŒ…ï¼ˆåœ°å›¾+è½¨è¿¹ï¼‰
â”‚   â”œâ”€â”€ map_00002.npz
â”‚   â””â”€â”€ ...
â””â”€â”€ index.json               # æ•°æ®é›†ç´¢å¼•ï¼ˆå¯é€‰ï¼‰
```

---

## âš™ï¸ é…ç½®è¯´æ˜

é…ç½®æ–‡ä»¶ä½ç½®ï¼š`obstruct_env/datasets/dataset_config.yaml`

### æ•°æ®é›†é…ç½®
```yaml
dataset:
  output_dir: obstruct_env/datasets/out  # è¾“å‡ºç›®å½•
  num_maps: 10                           # åœ°å›¾æ•°é‡
  tasks_per_map: 5                       # æ¯å¼ åœ°å›¾çš„è½¨è¿¹æ•°é‡
  seed: 2025                             # éšæœºç§å­ï¼ˆå¯é€‰ï¼‰
```

### åœ°å›¾é…ç½®
```yaml
map:
  size: [20.0, 20.0, 10.0]    # åœ°å›¾å°ºå¯¸ (x, y, z) ç±³
  resolution: 0.2             # æ …æ ¼åˆ†è¾¨ç‡ ç±³/æ ¼
  environment: city           # ç¯å¢ƒç±»å‹ï¼šcity|buildings|forest|custom
  
  # éšœç¢ç‰©é…ç½®ï¼ˆæ”¯æŒèŒƒå›´æˆ–å›ºå®šå€¼ï¼‰
  boxes:
    count: [10, 20]           # ç›’å­æ•°é‡èŒƒå›´
    size_range: [2.0, 5.0]    # å°ºå¯¸èŒƒå›´
  
  buildings:
    count: [15, 30]
    footprint_range: [2.0, 6.0]
    height_range: [3.0, 10.0]
    min_gap: 1.0              # å»ºç­‘é—´è·
  
  spheres:
    count: [6, 12]
    radius_range: [0.6, 2.0]
  
  cylinders:
    count: [5, 10]
    radius_range: [0.4, 1.2]
    height_range: [2.0, 6.0]
```

### è§„åˆ’å™¨é…ç½®
```yaml
planner:
  step: [0.6, 1.4]              # é‡‡æ ·æ­¥é•¿èŒƒå›´ï¼ˆç±³ï¼‰
  time_limit: [3.0, 8.0]        # è§„åˆ’æ—¶é—´é™åˆ¶ï¼ˆç§’ï¼‰
  max_iters: [3000, 8000]       # æœ€å¤§è¿­ä»£æ¬¡æ•°
  stop_on_first: true           # æ‰¾åˆ°é¦–ä¸ªè§£å³åœæ­¢
  
  # å®‰å…¨å‚æ•°
  inflate: [0.3, 0.8]           # ç¡¬è†¨èƒ€åŠå¾„ï¼ˆç±³ï¼‰
  safety_margin: [0.4, 1.0]     # è½¯å®‰å…¨è·ç¦»ï¼ˆç±³ï¼‰
  safety_weight: [0.5, 2.0]     # å®‰å…¨ä»£ä»·æƒé‡
  
  goal_tolerance: [0.01, 0.001] # ç›®æ ‡å®¹å·®ï¼ˆç±³ï¼‰
```

### ä»»åŠ¡é…ç½®
```yaml
task:
  min_distance: [10.0, 20.0]    # èµ·ç»ˆç‚¹æœ€å°è·ç¦»ï¼ˆç±³ï¼‰
  min_clearance: [0.8, 1.5]     # é‡‡æ ·ç‚¹åˆ°éšœç¢ç‰©æœ€å°è·ç¦»ï¼ˆç±³ï¼‰
  max_tries: 200                # é‡‡æ ·é‡è¯•æ¬¡æ•°
  
  preferences:
    safety_weight_range: [0.5, 2.0]  # æ¯ä¸ªä»»åŠ¡çš„å®‰å…¨åå¥½æ‰°åŠ¨
```

### é‡‡æ ·é…ç½®
```yaml
sampling:
  dt: 0.05    # è½¨è¿¹ç¦»æ•£é‡‡æ ·æ—¶é—´æ­¥é•¿ï¼ˆç§’ï¼‰
```

---

## ğŸ“¦ è¾“å‡ºæ•°æ®æ ¼å¼

æ¯ä¸ª `.npz` æ–‡ä»¶åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

### åœ°å›¾ç›¸å…³
```python
data = np.load('map_00001.npz', allow_pickle=True)

# å æ®æ …æ ¼ (nx, ny, nz)ï¼Œ0=è‡ªç”±ç©ºé—´ï¼Œ1=éšœç¢ç‰©
obstacle_map = data['obstacle_map']  # uint8

# æ¬§å‡ é‡Œå¾—ç¬¦å·è·ç¦»åœº (nx, ny, nz)
esdf = data['esdf']  # float32

# åœ°å›¾å…ƒæ•°æ®
resolution = data['resolution']  # float, å¦‚ 0.2
map_size = data['map_size']      # [x, y, z], å¦‚ [20, 20, 10]

# éšœç¢ç‰©åˆ—è¡¨
obstacles = data['obstacles']    # list of dict
# æ¯ä¸ªéšœç¢ç‰©: {type, center, size/radius/height, ...}
```

### ä»»åŠ¡ä¸è½¨è¿¹
```python
tasks = data['tasks']  # list of dict

for task in tasks:
    # èµ·ç‚¹å’Œç»ˆç‚¹çŠ¶æ€ [x, y, z, vx, vy, vz, ax, ay, az]
    start_state = task['start_state']  # shape (9,)
    goal_state = task['goal_state']    # shape (9,)
    
    # ä»»åŠ¡åå¥½
    preferences = task['preferences']
    # {'safety_weight': 1.2, 'notes': 'high_safety', ...}
    
    # çº¦æŸæ¡ä»¶
    constraints = task['constraints']
    # {'min_distance': 15.0, 'min_clearance': 1.0}
    
    # è§„åˆ’å™¨å‚æ•°ï¼ˆå®é™…ä½¿ç”¨å€¼ï¼‰
    planner_params = task['planner_params']
    # {'step': 1.0, 'time_limit': 5.0, 'inflate': 0.5, ...}
    
    # è§„åˆ’ç»“æœ
    result = task['result']
    
    if result['success']:
        # è½¨è¿¹ä»£ä»·
        cost = result['cost']
        
        # å¤šé¡¹å¼ç³»æ•° (M, 6, 3)
        # M æ®µï¼Œ6 é˜¶å¤šé¡¹å¼ï¼Œ3 ä¸ªç»´åº¦ (x, y, z)
        coefficients = result['coefficients']
        
        # æ—¶é—´é—´éš” (M,)
        intervals = result['intervals']
        
        # ç¦»æ•£é‡‡æ ·è½¨è¿¹
        trajectory = result['trajectory']
        positions = trajectory['positions']      # (N, 3)
        velocities = trajectory['velocities']    # (N, 3)
        accelerations = trajectory['accelerations']  # (N, 3)
        times = trajectory['times']              # (N,)
        
        # å…¨å±€è·¯å¾„ç‚¹
        global_waypoints = result['global_waypoints']  # (M+1, 3)
        
        # ç»ˆç«¯å§¿æ€
        terminal_attitude = result['terminal_attitude']
        # {'yaw': ..., 'pitch': ..., 'roll': ..., 'final_tangent': [...]}
```

### é…ç½®å­˜æ¡£
```python
# ä¿å­˜ç”Ÿæˆæ—¶çš„é…ç½®ï¼Œä¾¿äºè¿½æº¯
planner_spec = data['planner_spec']  # dict
sampling = data['sampling']          # {'dt': 0.05}
task_spec = data['task_spec']        # dict
```

---

## ğŸ”§ é«˜çº§ä½¿ç”¨

### 1. ä»…ç”Ÿæˆåœ°å›¾ï¼ˆä¸è§„åˆ’è½¨è¿¹ï¼‰

ä¿®æ”¹ `generate_dataset.py` æˆ–è‡ªå®šä¹‰è„šæœ¬ï¼š

```python
from obstruct_env.core.obstacle_map import ObstacleMapGenerator
from obstruct_env.core.esdf import compute_esdf

# åˆ›å»ºåœ°å›¾ç”Ÿæˆå™¨
gen = ObstacleMapGenerator(map_size=(20, 20, 10), resolution=0.2)

# æ·»åŠ éšœç¢ç‰©
gen.add_random_obstacles(
    num_boxes=15,
    num_spheres=8,
    box_size_range=(2.0, 5.0),
    sphere_radius_range=(0.6, 2.0)
)

# è·å–å æ®æ …æ ¼
obstacle_map = gen.obstacle_map

# è®¡ç®— ESDF
esdf = compute_esdf(obstacle_map, resolution=0.2)

# ä¿å­˜
np.savez('custom_map.npz', 
         obstacle_map=obstacle_map, 
         esdf=esdf,
         resolution=0.2,
         map_size=[20, 20, 10])
```

### 2. å•ç‹¬è°ƒç”¨è§„åˆ’å™¨

```python
from cpp_bridge import CppKinoRRTStarBridge
import numpy as np

# åˆ›å»ºæ¡¥æ¥å™¨ï¼ˆéœ€è¦å…ˆç¼–è¯‘ C++ï¼‰
bridge = CppKinoRRTStarBridge(method="executable")

# åŠ è½½åœ°å›¾
data = np.load('map_00001.npz', allow_pickle=True)
obstacle_map = data['obstacle_map']
esdf = data['esdf']
resolution = float(data['resolution'])
map_size = data['map_size']

# å®šä¹‰èµ·ç‚¹å’Œç»ˆç‚¹
start_pos = np.array([1.0, 1.0, 2.0])
start_vel = np.array([0.0, 0.0, 0.0])
start_acc = np.array([0.0, 0.0, 0.0])
goal_pos = np.array([18.0, 18.0, 8.0])

# è°ƒç”¨è§„åˆ’
result = bridge.plan(
    start_pos=start_pos,
    start_vel=start_vel,
    start_acc=start_acc,
    goal_pos=goal_pos,
    obstacle_map=obstacle_map,
    esdf=esdf,
    resolution=resolution,
    map_size=map_size,
    inflate_radius=0.5,
    safety_margin=0.8,
    safety_weight=1.0
)

if result and result['success']:
    print(f"è§„åˆ’æˆåŠŸï¼ä»£ä»·: {result['cost']}")
    trajectory = result['trajectory']
    # trajectory åŒ…å« positions, velocities, accelerations, times
```

### 3. å¯è§†åŒ–

```python
from obstruct_env.visualization import plot_trajectory_3d
import matplotlib.pyplot as plt

data = np.load('map_00001.npz', allow_pickle=True)
task = data['tasks'][0]

if task['result']['success']:
    trajectory = task['result']['trajectory']
    
    fig = plt.figure(figsize=(12, 8))
    ax = fig.add_subplot(111, projection='3d')
    
    # ç»˜åˆ¶è½¨è¿¹
    positions = trajectory['positions']
    ax.plot(positions[:, 0], positions[:, 1], positions[:, 2], 
            'b-', linewidth=2, label='Trajectory')
    
    # ç»˜åˆ¶èµ·ç»ˆç‚¹
    start = task['start_state'][:3]
    goal = task['goal_state'][:3]
    ax.scatter(*start, c='green', s=100, marker='o', label='Start')
    ax.scatter(*goal, c='red', s=100, marker='*', label='Goal')
    
    ax.legend()
    plt.show()
```

---

## ğŸ¯ å…¸å‹å·¥ä½œæµ

### ç§‘ç ”/å®éªŒæµç¨‹

1. **é…ç½®å®éªŒå‚æ•°**
   ```bash
   # ç¼–è¾‘é…ç½®æ–‡ä»¶
   vim obstruct_env/datasets/dataset_config.yaml
   ```

2. **ç”Ÿæˆè®­ç»ƒé›†**
   ```bash
   python3 obstruct_env/datasets/generate_dataset.py \
       --config obstruct_env/datasets/dataset_config.yaml \
       --num-maps 100 --tasks-per-map 10 \
       --out-dir data/train --seed 42
   ```

3. **ç”ŸæˆéªŒè¯é›†**
   ```bash
   python3 obstruct_env/datasets/generate_dataset.py \
       --config obstruct_env/datasets/dataset_config.yaml \
       --num-maps 20 --tasks-per-map 10 \
       --out-dir data/val --seed 123
   ```

4. **ç”Ÿæˆæµ‹è¯•é›†**ï¼ˆä¸åŒåˆ†å¸ƒï¼‰
   ```bash
   # å¯ä¿®æ”¹é…ç½®åˆ›å»ºæ›´å›°éš¾çš„æµ‹è¯•åœºæ™¯
   python3 obstruct_env/datasets/generate_dataset.py \
       --config obstruct_env/datasets/dataset_config_hard.yaml \
       --num-maps 50 --tasks-per-map 5 \
       --out-dir data/test --seed 456
   ```

5. **éªŒè¯æ•°æ®è´¨é‡**
   ```bash
   python3 verify_trajectory_data.py
   python3 verify_data_flow.py
   ```

6. **è®­ç»ƒæ¨¡å‹**
   ```bash
   cd CHDM
   python3 train.py --config config/train_config.yaml
   ```

---

## ğŸ“Š æ€§èƒ½å‚æ•°

### åœ°å›¾ç”Ÿæˆé€Ÿåº¦
- ç®€å•åœ°å›¾ï¼ˆ10-20 éšœç¢ç‰©ï¼‰ï¼š~0.5 ç§’/å¼ 
- å¤æ‚åœ°å›¾ï¼ˆ50+ éšœç¢ç‰©ï¼‰ï¼š~2 ç§’/å¼ 
- ESDF è®¡ç®—ï¼š~0.3 ç§’ï¼ˆ20Ã—20Ã—10 ç±³ï¼Œ0.2 ç±³åˆ†è¾¨ç‡ï¼‰

### è½¨è¿¹è§„åˆ’é€Ÿåº¦
- ç®€å•åœºæ™¯ï¼š1-3 ç§’/æ¡
- å¤æ‚åœºæ™¯ï¼š5-10 ç§’/æ¡
- å¤±è´¥é‡è¯•ï¼šè‡ªåŠ¨é‡æ–°é‡‡æ ·èµ·ç»ˆç‚¹

### æ•°æ®é›†è§„æ¨¡
- å•ä¸ª .npz æ–‡ä»¶ï¼š~500 KB - 2 MBï¼ˆå–å†³äºåœ°å›¾å¤æ‚åº¦å’Œè½¨è¿¹æ•°é‡ï¼‰
- 100 å¼ åœ°å›¾ Ã— 10 æ¡è½¨è¿¹ï¼š~50-150 MB

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: C++ ç¼–è¯‘å¤±è´¥
**A:** æ£€æŸ¥ä¾èµ–é¡¹
```bash
# Ubuntu/Debian
sudo apt install build-essential cmake libeigen3-dev

# æŒ‡å®š Eigen è·¯å¾„
cmake -DEigen3_DIR=/usr/share/eigen3/cmake ..
```

### Q2: è§„åˆ’ç»å¸¸å¤±è´¥
**A:** è°ƒæ•´é…ç½®å‚æ•°
- å¢åŠ  `planner.time_limit` å’Œ `planner.max_iters`
- å‡å° `planner.inflate` æˆ– `task.min_clearance`
- å¢åŠ  `task.max_tries` é‡‡æ ·é‡è¯•æ¬¡æ•°
- é™ä½éšœç¢ç‰©å¯†åº¦

### Q3: å†…å­˜å ç”¨è¿‡å¤§
**A:** ä¼˜åŒ–æ•°æ®é›†
- å‡å°åœ°å›¾å°ºå¯¸æˆ–å¢å¤§åˆ†è¾¨ç‡ï¼ˆé™ä½æ …æ ¼æ•°ï¼‰
- ä»…ä¿å­˜è½¨è¿¹ç³»æ•°ï¼Œä¸ä¿å­˜å®Œæ•´é‡‡æ ·ç‚¹
- åˆ†æ‰¹ç”Ÿæˆå’Œå¤„ç†æ•°æ®

### Q4: å¦‚ä½•åŠ é€Ÿç”Ÿæˆï¼Ÿ
**A:** å¹¶è¡ŒåŒ–
- ä½¿ç”¨ Python `multiprocessing` å¹¶è¡Œç”Ÿæˆå¤šå¼ åœ°å›¾
- ä½¿ç”¨ pybind11 æ¨¡å¼è€Œéå¯æ‰§è¡Œæ–‡ä»¶æ¨¡å¼
- é¢„ç¼–è¯‘ C++ ä¸º Release æ¨¡å¼ï¼ˆ`cmake -DCMAKE_BUILD_TYPE=Release ..`ï¼‰

### Q5: è½¨è¿¹ä¸å¹³æ»‘
**A:** è°ƒæ•´è§„åˆ’å‚æ•°
- å‡å° `planner.step`ï¼ˆæ›´ç»†çš„é‡‡æ ·ï¼‰
- å¢åŠ  `safety_weight`ï¼ˆæ›´å¹³æ»‘ä½†å¯èƒ½ç»•è¿œï¼‰
- æ£€æŸ¥é€Ÿåº¦å’ŒåŠ é€Ÿåº¦çº¦æŸæ˜¯å¦åˆç†

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [READY_TO_TRAIN.md](READY_TO_TRAIN.md) - æ¨¡å‹è®­ç»ƒæŒ‡å—
- [obstruct_env/datasets/README.md](obstruct_env/datasets/README.md) - æ•°æ®é›†å·¥å…·è¯¦ç»†è¯´æ˜
- [cpp/kinodyn_rrt_star/README.md](cpp/kinodyn_rrt_star/README.md) - C++ è§„åˆ’å™¨æ–‡æ¡£
- [CHDM/models/CHDMX_ARCHITECTURE.md](CHDM/models/CHDMX_ARCHITECTURE.md) - æ¨¡å‹æ¶æ„è¯´æ˜

---

## ğŸ¤ è´¡çŒ®

å¦‚éœ€ä¿®æ”¹æˆ–æ‰©å±•åŠŸèƒ½ï¼š

1. **æ·»åŠ æ–°çš„éšœç¢ç‰©ç±»å‹**ï¼šç¼–è¾‘ `obstruct_env/core/obstacle_map.py`
2. **æ·»åŠ æ–°çš„ç¯å¢ƒé¢„è®¾**ï¼šç¼–è¾‘ `obstruct_env/generators/environment_builder.py`
3. **ä¿®æ”¹è§„åˆ’å™¨å‚æ•°**ï¼šç¼–è¾‘ `cpp/kinodyn_rrt_star/src/kinodyn_rrt_star.cpp`
4. **è‡ªå®šä¹‰æ•°æ®æ ¼å¼**ï¼šç¼–è¾‘ `obstruct_env/datasets/generate_dataset.py`

---

## ğŸ“ è®¸å¯è¯

è¯·å‚è€ƒé¡¹ç›®æ ¹ç›®å½•çš„ LICENSE æ–‡ä»¶ã€‚

---

**æœ€åæ›´æ–°**: 2026å¹´2æœˆ4æ—¥
